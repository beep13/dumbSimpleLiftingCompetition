<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Weekly Workout Routine</title>
</head>
<body>
    <h1>Admin - Weekly Workout Routine</h1>
    <form method="POST">
        {% for day in ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'] %}
            <h2>{{ day }}</h2>
            <label for="{{ day }}_name">Workout Name:</label>
            <input type="text" id="{{ day }}_name" name="{{ day }}_name" value="{{ weekly_workouts|selectattr('day', 'equalto', day)|map(attribute='name')|first or '' }}">
            <div id="{{ day }}_exercises">
                {% set workout = weekly_workouts|selectattr('day', 'equalto', day)|first %}
                {% if workout %}
                    {% for exercise in workout.exercises %}
                        <div>
                            <select name="{{ day }}_exercise_{{ loop.index }}">
                                {% for ex in exercises %}
                                    <option value="{{ ex.id }}" {% if ex.id == exercise.exercise_id %}selected{% endif %}>{{ ex.name }}</option>
                                {% endfor %}
                            </select>
                            <input type="number" name="{{ day }}_sets_{{ loop.index }}" value="{{ exercise.sets }}" min="1" placeholder="Sets">
                            <input type="number" name="{{ day }}_reps_{{ loop.index }}" value="{{ exercise.reps }}" min="1" placeholder="Reps">
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
            <button type="button" onclick="addExercise('{{ day }}')">Add Exercise</button>
            <input type="hidden" id="{{ day }}_exercise_count" name="{{ day }}_exercise_count" value="{{ workout.exercises|length if workout else 0 }}">
        {% endfor %}
        <input type="submit" value="Save Weekly Routine">
    </form>

    <script>
        function addExercise(day) {
            const container = document.getElementById(`${day}_exercises`);
            const count = container.children.length + 1;
            const div = document.createElement('div');
            div.innerHTML = `
                <select name="${day}_exercise_${count}">
                    {% for exercise in exercises %}
                        <option value="{{ exercise.id }}">{{ exercise.name }}</option>
                    {% endfor %}
                </select>
                <input type="number" name="${day}_sets_${count}" min="1" placeholder="Sets">
                <input type="number" name="${day}_reps_${count}" min="1" placeholder="Reps">
            `;
            container.appendChild(div);
            document.getElementById(`${day}_exercise_count`).value = count;
        }
    </script>
</body>
</html>

